window.onload=(()=>{for(let e=11;e<15;e++){let a={method:"request",type:"games",qual:"week",crit:e};ws.send(JSON.stringify(a))}ws.send(JSON.stringify({method:"request",type:"playoffOrder",qual:"CFC"}))}),ws.onmessage=(e=>{const a=JSON.parse(e.data);console.log(a),"requested"==a.method&&("games"==a.type?(cacheGames[a.crit-11]=a,renderGames(a)):"playoffOrder"==a.type&&(cachePlayoffs[a.qual.toLowerCase()]=a.data,playoffs=a.data,wildCard&&updateWildCard(),updateHunt(),updateStandings()))});var currConf="CFC",wildCard=!1,playoffs=[],needRefresh=!1,cachePlayoffs={cfc:[],nfc:[]},cacheGames=[];function renderGames(e){if(needRefresh){for(let e of document.getElementsByClassName("playoffGroup"))e.innerHTML="";needRefresh=!1}var a=document.getElementsByClassName("playoffGroup")[13-e.crit];if(14!=e.crit){for(let l=0;l<e.data.length;l++){let t=e.data[l];"CFC"==currConf&&l%2==0?11==e.crit?renderGame(t,a,l):renderGame(t,a):"NFC"==currConf&&l%2==1&&(11==e.crit?renderGame(t,a,l):renderGame(t,a))}11==e.crit&&(wildCard=!0,0!=playoffs.length&&updateWildCard())}else updateChamp(e.data[0])}function updateChamp(e){if("CFC"!=e.away&&"NFC"!=e.home){var a=document.getElementsByClassName("champMatchup");a[0].classList.remove("cfc"),a[0].classList.add(cleanObj(e.awayTeam.mascot)),a[0].children[0].src=`logos/${cleanObj(e.awayTeam.mascot)}.png`,a[0].children[1].textContent=e.awayTeam.mascot,a[0].children[2].textContent=e.awayTeam.abbr,a[1].classList.remove("nfc"),a[1].classList.add(cleanObj(e.homeTeam.mascot)),a[1].children[0].src=`logos/${cleanObj(e.homeTeam.mascot)}.png`,a[1].children[1].textContent=e.homeTeam.mascot,a[1].children[2].textContent=e.homeTeam.abbr,"upcoming"!=e.status&&(a[0].children[3].textContent=e.awayScore,a[1].children[3].textContent=e.homeScore)}}function renderGame(e,a,l){var t=buildElem("DIV","gameRow",void 0,a),n=new Date(e.schedule);buildElem("DIV","gameTime",`${numToDay(n.getDay())} ${n.getDate()} ${numToMon(n.getMonth())} ${e.time}`,t);var o=buildElem("DIV","gameMain",void 0,t),s=buildElem("DIV","gameHalf",void 0,o);s.classList.add(cleanObj(e.awayTeam)),buildElem("IMG","gameLogo",void 0,s).src=`logos/${cleanObj(e.awayTeam)}.png`,buildElem("DIV","gameName",e.awayTeam.mascot,s),buildElem("DIV","gameAbbr",e.away,s),"upcoming"==e.status?buildElem("DIV","gameScore","-",s):buildElem("DIV","gameScore",e.awayScore,s);var i=buildElem("DIV","gameHalf",void 0,o);i.classList.add(cleanObj(e.homeTeam)),"upcoming"==e.status?buildElem("DIV","gameScore","-",i):buildElem("DIV","gameScore",e.homeScore,i),buildElem("DIV","gameName",e.homeTeam.mascot,i),buildElem("DIV","gameAbbr",e.home,i),buildElem("IMG","gameLogo",void 0,i).src=`logos/${cleanObj(e.homeTeam)}.png`,"CFC"==e.away||"NFC"==e.away?t.setAttribute("data-fixable","true"):t.setAttribute("data-fixable","false"),null!=l&&(l=Math.floor(l/2),buildElem("DIV","gameSeed",8-l,s),buildElem("DIV","gameSeed",l+1,i))}function updateWildCard(){fixWCRow(playoffs[7],playoffs[0],0),fixWCRow(playoffs[6],playoffs[1],1),fixWCRow(playoffs[5],playoffs[2],2),fixWCRow(playoffs[4],playoffs[3],3)}function fixWCRow(e,a,l){var t=document.getElementsByClassName("playoffGroup")[2].children[l];if("false"!=t.getAttribute("data-fixable")){var n=t.children[1].children[0];n.className="",n.classList.add("gameHalf",cleanObj(e)),n.children[0].src=`logos/${cleanObj(e)}.png`,n.children[1].textContent=e.mascot,n.children[2].textContent=e.abbr,e.clinchedDiv?buildElem("DIV","gameClinch","xy",n):e.clinched&&buildElem("DIV","gameClinch","x",n);var o=t.children[1].children[1];o.className="",o.classList.add("gameHalf",cleanObj(a)),o.children[3].src=`logos/${cleanObj(a)}.png`,o.children[1].textContent=a.mascot,o.children[2].textContent=a.abbr,a.clinchedDiv?buildElem("DIV","gameClinch","xy",o):a.clinched&&buildElem("DIV","gameClinch","x",o)}}function updateHunt(){document.getElementsByClassName("playoffGroup")[3].innerHTML="",document.getElementsByClassName("playoffGroup")[4].innerHTML="";for(let a=8;a<20;a++){let l=playoffs[a];if(l.eliminated)var e=buildElem("DIV","gameHunt",void 0,document.getElementsByClassName("playoffGroup")[4]);else e=buildElem("DIV","gameHunt",void 0,document.getElementsByClassName("playoffGroup")[3]);e.classList.add(cleanObj(l)),buildElem("IMG","gameLogo",void 0,e).src=`logos/${cleanObj(l)}.png`,buildElem("DIV","gameName",l.mascot,e),buildElem("DIV","gameAbbr",l.abbr,e),buildElem("DIV","gameSeed",a+1,e)}}function updateStandings(){for(let e of document.getElementsByClassName("standingsGroup"))e.innerHTML="";for(let t of playoffs){for(let a of document.getElementsByClassName("standingsGroup"))if(-1!=t.division.indexOf(a.getAttribute("data-div"))){var e=a;break}var a=buildElem("DIV","standingsRow",void 0,e);a.classList.add(cleanObj(t)),buildElem("IMG","standingsLogo",void 0,a).src=`logos/${cleanObj(t)}.png`;var l=buildElem("DIV","standingsTont",void 0,a);buildElem("SPAN","standingsAbbr",t.abbr,l),buildElem("SPAN","standingsName",t.mascot,l),t.clinchedDiv?buildElem("SPAN","standingsClinch","[xy]",l):t.clinched?buildElem("SPAN","standingsClinch","[x]",l):t.eliminated&&buildElem("SPAN","standingsClinch","[*]",l),buildElem("DIV","standingsRecord",getFormatRecord(t.w,t.l,t.t),a)}}function goToCon(e,a){if(e==currConf)return;if(a.style.textDecoration="underline","CFC"==e?a.nextElementSibling.style.textDecoration="none":a.previousElementSibling.style.textDecoration="none",needRefresh=!0,currConf=e,cachePlayoffs[e.toLowerCase()].length>0){playoffs=cachePlayoffs[e.toLowerCase()];for(let a=0;a<3;a++)renderGames(cacheGames[a]),playoffs=cachePlayoffs[e.toLowerCase()],updateHunt(),updateStandings();return}for(let e=11;e<15;e++){let a={method:"request",type:"games",qual:"week",crit:e};ws.send(JSON.stringify(a))}let l={method:"request",type:"playoffOrder",qual:currConf};ws.send(JSON.stringify(l))}